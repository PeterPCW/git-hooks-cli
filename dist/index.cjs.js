"use strict";var C=Object.create;var w=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var H=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var x=(t,e,s)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var R=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of S(e))!O.call(t,o)&&o!==s&&w(t,o,{get:()=>e[o],enumerable:!(r=v(e,o))||r.enumerable});return t};var k=(t,e,s)=>(s=t!=null?C(H(t)):{},R(e||!t||!t.__esModule?w(s,"default",{value:t,enumerable:!0}):s,t));var d=(t,e,s)=>x(t,typeof e!="symbol"?e+"":e,s);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const P=["applypatch-msg","commit-msg","fsmonitor-watchman","post-applypatch","post-checkout","post-commit","post-merge","post-receive","post-rewrite","post-update","pre-applypatch","pre-auto-gc","pre-checkout","pre-commit","pre-merge-commit","pre-push","pre-rebase","pre-receive","prepare-commit-msg","push-to-checkout","reference-transaction","sendemail-validate","shallow-clone","update","worktree-guid"];class y{constructor(){d(this,"hooks",new Map);d(this,"parallel",!1);d(this,"ignorePatterns",[]);d(this,"color",!1)}parallelExec(e=!0){return this.parallel=e,this}ignore(e){return this.ignorePatterns=e,this}useColors(e=!0){return this.color=e,this}register(e){return this.hooks.set(e.name,e),this}unregister(e){return this.hooks.delete(e),this}get(e){return this.hooks.get(e)}list(){return Array.from(this.hooks.values())}shouldIgnore(e){return this.ignorePatterns.length===0?!1:e.some(s=>this.ignorePatterns.some(r=>this.matchIgnorePattern(s,r)))}matchIgnorePattern(e,s){if(s.endsWith("/")){const r=s.slice(0,-1);return e.startsWith(s)||e.includes("/"+r+"/")||e.endsWith("/"+r)}if(s.includes("*")){const r=s.replace(/\./g,"\\.").replace(/\*\*/g,"§§§").replace(/\*/g,"[^/]*").replace(/§§§/g,".*");return new RegExp(`^${r}$`).test(e)}return e===s||e.endsWith("/"+s)||e.includes("/"+s+"/")}async runCommand(e,s=[]){try{const{spawn:r}=await import("child_process"),o=process.platform==="win32",l=o||e.includes("&&")||e.includes("||"),c=l?o?["/c",e,...s]:["-c",e,...s]:s,i=l?o?"cmd.exe":"/bin/sh":e;return new Promise(p=>{var h,a,f;const n=r(i,c,{stdio:"pipe",cwd:process.cwd(),env:{...process.env,FORCE_COLOR:this.color?"1":void 0}});let m="",g="";(h=n.stdout)==null||h.on("data",u=>{m+=u,process.stdout.write(u)}),(a=n.stderr)==null||a.on("data",u=>{g+=u,process.stderr.write(u)}),n.on("close",u=>{p(u===0)}),n.on("error",()=>{p(!1)}),(f=n.stdin)==null||f.end()})}catch{return!1}}async run(e,s=[]){const r=this.hooks.get(e);if(!r)return!1;if(this.shouldIgnore(s)||r.condition&&!r.condition(s))return!0;const o=r.command.split("&&").map(c=>c.trim());if((r.parallel??this.parallel)&&o.length>1)return(await Promise.all(o.map(i=>this.runCommand(i,r.args)))).every(i=>i);for(const c of o)if(!await this.runCommand(c,r.args))return!1;return!0}async runAll(e=[]){let s=!0;for(const r of this.hooks.values())await this.run(r.name,e)||(s=!1);return s}clear(){return this.hooks.clear(),this}count(){return this.hooks.size}}function I(){return new y}function W(t){return t}async function b(t,e=[],s={}){const{spawn:r}=await import("child_process"),o=process.platform==="win32",l=o||t.includes("&&")||t.includes("||"),c=l?o?["/c",t,...e]:["-c",t,...e]:e,i=l?o?"cmd.exe":"/bin/sh":t;return new Promise(p=>{var m,g,h;const n=r(i,c,{stdio:"pipe",cwd:s.cwd||process.cwd(),env:{...process.env,...s.env}});(m=n.stdout)==null||m.on("data",a=>process.stdout.write(a)),(g=n.stderr)==null||g.on("data",a=>process.stderr.write(a)),n.on("close",a=>{p(a===0)}),n.on("error",()=>{p(!1)}),(h=n.stdin)==null||h.end()})}function A(){return P}exports.GIT_HOOKS=P;exports.HookRunner=y;exports.createHookRunner=I;exports.defineConfig=W;exports.getSupportedHooks=A;exports.spawnCommand=b;
